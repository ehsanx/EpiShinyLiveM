[{"name":"app.R","content":"library(shiny)\r\nlibrary(ggplot2)\r\n\r\nlist.res <- list(structure(list(term = structure(1:17, levels = c(\"(Intercept)\", \r\n                                                      \"arthritisRheumatoid arthritis\", \"age.cat50-64\", \"age.cat65+\", \r\n                                                      \"sexFemale\", \"educationHigh school\", \"educationCollege graduate or above\", \r\n                                                      \"raceBlack\", \"raceHispanic\", \"raceOthers\", \"income$20,000 to $74,999\", \r\n                                                      \"income$75,000 and Over\", \"bmi\", \"smokingPrevious smoker\", \"smokingCurrent smoker\", \r\n                                                      \"htnYes\", \"diabetesYes\"), class = \"factor\"), Estimate = c(0.0185644846592611, \r\n                                                                                                                2.02945001400264, 4.70840309443732, 13.0762146956801, 0.456347892521706, \r\n                                                                                                                0.745280039323373, 0.746871678985844, 0.9631457620034, 0.537570187649617, \r\n                                                                                                                0.863698941919151, 0.480993370693866, 0.327874783023796, 1.0240233317945, \r\n                                                                                                                1.54988622830053, 1.43060942743583, 1.34743060758216, 3.01376829095726\r\n                                                      ), lower = c(0.00781982712743994, 1.2588355913491, 2.4283203278761, \r\n                                                                   7.94078778296865, 0.344554460584949, 0.430137510861569, 0.424220468115746, \r\n                                                                   0.655725599263099, 0.278875733440132, 0.439058528107742, 0.330188239867475, \r\n                                                                   0.210620689977275, 0.999005951345862, 1.22191187574204, 1.01659107077758, \r\n                                                                   0.771084646383314, 1.95410234296602), upper = c(0.0440725971363984, \r\n                                                                                                                   3.27180720630984, 9.12938027377007, 21.5327994451952, 0.604413591556619, \r\n                                                                                                                   1.29131341254403, 1.31492312794048, 1.41469199907339, 1.03623826671775, \r\n                                                                                                                   1.6990351274744, 0.700674932409173, 0.510405095313763, 1.04966720433127, \r\n                                                                                                                   1.96589244147976, 2.01324150162248, 2.35456541738308, 4.64806735648923\r\n                                                                   )), row.names = c(NA, -17L), class = \"data.frame\"), structure(list(\r\n                                                                     term = structure(1:17, levels = c(\"(Intercept)\", \"arthritisRheumatoid arthritis\", \r\n                                                                                                       \"age.cat50-64\", \"age.cat65+\", \"sexFemale\", \"educationHigh school\", \r\n                                                                                                       \"educationCollege graduate or above\", \"raceBlack\", \"raceHispanic\", \r\n                                                                                                       \"raceOthers\", \"income$20,000 to $74,999\", \"income$75,000 and Over\", \r\n                                                                                                       \"bmi\", \"smokingPrevious smoker\", \"smokingCurrent smoker\", \r\n                                                                                                       \"htnYes\", \"diabetesYes\"), class = \"factor\"), Estimate = c(0.0160925849470739, \r\n                                                                                                                                                                 2.04174037516952, 4.7408491014501, 13.2123646157459, 0.450250611737286, \r\n                                                                                                                                                                 0.759976344650721, 0.787355761890748, 0.970150204624201, \r\n                                                                                                                                                                 0.540188074561677, 0.875751234929331, 0.478373197653768, \r\n                                                                                                                                                                 0.316035725642972, 1.0289592608228, 1.54955206717135, 1.46766765092429, \r\n                                                                                                                                                                 1.29921476376405, 3.00827223522849), lower = c(0.0058853891474442, \r\n                                                                                                                                                                                                                1.24866780661164, 2.45367494087991, 7.88741321249406, 0.339552896133263, \r\n                                                                                                                                                                                                                0.43677306625514, 0.441191327494545, 0.666048579576288, 0.282572407086925, \r\n                                                                                                                                                                                                                0.439026649503152, 0.323510701874952, 0.201900627086765, \r\n                                                                                                                                                                                                                0.995370951771526, 1.20415222646427, 1.03868544758108, 0.743704738947783, \r\n                                                                                                                                                                                                                1.9490344715991), upper = c(0.0440024072819807, 3.33852105221601, \r\n                                                                                                                                                                                                                                            9.1599950051494, 22.1322978822629, 0.597036914361164, 1.32234354416737, \r\n                                                                                                                                                                                                                                            1.40512529859333, 1.41309725505477, 1.03266684425025, 1.74691041272368, \r\n                                                                                                                                                                                                                                            0.707367375815426, 0.494691776463665, 1.06368099104023, 1.99402663226835, \r\n                                                                                                                                                                                                                                            2.0738216161457, 2.26966282986265, 4.64317177203217)), row.names = c(NA, \r\n                                                                                                                                                                                                                                                                                                                 -17L), class = \"data.frame\"), structure(list(term = structure(1:17, levels = c(\"(Intercept)\", \r\n                                                                                                                                                                                                                                                                                                                                                                                                \"arthritisRheumatoid arthritis\", \"age.cat50-64\", \"age.cat65+\", \r\n                                                                                                                                                                                                                                                                                                                                                                                                \"sexFemale\", \"educationHigh school\", \"educationCollege graduate or above\", \r\n                                                                                                                                                                                                                                                                                                                                                                                                \"raceBlack\", \"raceHispanic\", \"raceOthers\", \"income$20,000 to $74,999\", \r\n                                                                                                                                                                                                                                                                                                                                                                                                \"income$75,000 and Over\", \"bmi\", \"smokingPrevious smoker\", \"smokingCurrent smoker\", \r\n                                                                                                                                                                                                                                                                                                                                                                                                \"htnYes\", \"diabetesYes\"), class = \"factor\"), Estimate = c(0.0227480787572519, \r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                          2.11955492722073, 4.58449544022195, 11.8818935591638, 0.467339213121321, \r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                          0.713484313664558, 0.704093348308456, 0.984786376697293, 0.535936957094921, \r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                          0.849793188888832, 0.535298814627975, 0.361918146727502, 1.01344729593354, \r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                          1.59247640570925, 1.44931242069464, 1.47788468202456, 3.13052022511674\r\n                                                                                                                                                                                                                                                                                                                                                                                                ), lower = c(0.010959287465499, 1.29978243127034, 2.4352826477349, \r\n                                                                                                                                                                                                                                                                                                                                                                                                             7.42358403525449, 0.353809910358682, 0.413348295355282, 0.391512809897396, \r\n                                                                                                                                                                                                                                                                                                                                                                                                             0.681127076783983, 0.280727023245673, 0.440772311822411, 0.349960986799173, \r\n                                                                                                                                                                                                                                                                                                                                                                                                             0.22362616429289, 0.994389510313301, 1.24324436017776, 1.03763247092058, \r\n                                                                                                                                                                                                                                                                                                                                                                                                             0.847766809082958, 2.04589631414903), upper = c(0.0472179499602691, \r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                             3.45635775759404, 8.63045546723895, 19.0176865892322, 0.617297406676489, \r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                             1.23155186936924, 1.26623556266814, 1.42382272087555, 1.02315914819786, \r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                             1.63837075177446, 0.818790755972322, 0.58573085732095, 1.032870329969, \r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                             2.03980905441474, 2.02432609969905, 2.57634895582367, 4.79015325072387\r\n                                                                                                                                                                                                                                                                                                                                                                                                             )), row.names = c(NA, -17L), class = \"data.frame\"), structure(list(\r\n                                                                                                                                                                                                                                                                                                                                                                                                               term = structure(1:17, levels = c(\"(Intercept)\", \"arthritisRheumatoid arthritis\", \r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                 \"age.cat50-64\", \"age.cat65+\", \"sexFemale\", \"educationHigh school\", \r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                 \"educationCollege graduate or above\", \"raceBlack\", \"raceHispanic\", \r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                 \"raceOthers\", \"income$20,000 to $74,999\", \"income$75,000 and Over\", \r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                 \"bmi\", \"smokingPrevious smoker\", \"smokingCurrent smoker\", \r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                 \"htnYes\", \"diabetesYes\"), class = \"factor\"), Estimate = c(0.018114287718039, \r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           2.10342073062848, 4.58920560424818, 12.4485063417391, 0.462926653774358, \r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           0.702756414632999, 0.714226215585185, 0.962858040946436, \r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           0.526926744415328, 0.861392292301939, 0.505395670307807, \r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           0.341786633384218, 1.02344534941338, 1.56405988205805, 1.43607385339439, \r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           1.46378487530669, 3.03015085246419), lower = c(0.00767305714708894, \r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          1.29748660476339, 2.41872880215434, 7.75543951422145, 0.349945485203922, \r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          0.40272550142363, 0.398361259005912, 0.660105008077245, 0.271660081337404, \r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          0.442737837914212, 0.333816322187789, 0.223095021012076, \r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          0.996187551110003, 1.22537996221836, 1.02001200868016, 0.829167287685552, \r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          1.98582425042902), upper = c(0.0427635834377159, 3.40996103836038, \r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       8.70738714456295, 19.9814994180733, 0.612384202213225, 1.22631066709711, \r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       1.28054391710205, 1.40446685856187, 1.02205591860694, 1.67592786903604, \r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       0.765165651253528, 0.523624876208217, 1.05144897872772, 1.99634675781284, \r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       2.02184689479444, 2.5841180579584, 4.6236791532311)), row.names = c(NA, \r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           -17L), class = \"data.frame\"), structure(list(term = structure(1:17, levels = c(\"(Intercept)\", \r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          \"arthritisRheumatoid arthritis\", \"age.cat50-64\", \"age.cat65+\", \r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          \"sexFemale\", \"educationHigh school\", \"educationCollege graduate or above\", \r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          \"raceBlack\", \"raceHispanic\", \"raceOthers\", \"income$20,000 to $74,999\", \r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          \"income$75,000 and Over\", \"bmi\", \"smokingPrevious smoker\", \"smokingCurrent smoker\", \r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          \"htnYes\", \"diabetesYes\"), class = \"factor\"), Estimate = c(0.0191500101047314, \r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    2.07227576620414, 4.47330388004576, 12.2514346619255, 0.454864699031287, \r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    0.750950781553528, 0.766293324950561, 0.986754736588158, 0.554413469761684, \r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    0.873701681480192, 0.534773498212856, 0.341314655226359, 1.01871880310256, \r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    1.55182607052081, 1.44637465382684, 1.47402063591999, 3.05287479320651\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          ), lower = c(0.00759273529608175, 1.27123604180771, 2.33635079631736, \r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       7.39863902878231, 0.344220231777332, 0.440024694820085, 0.436953154039478, \r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       0.675568646414702, 0.292211919822144, 0.45312822550409, 0.364807097560229, \r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       0.22268962226411, 0.988479414379156, 1.21479274454788, 1.0113846292597, \r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       0.79481924190652, 1.96539165914269), upper = c(0.0482991797699789, \r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      3.37807197874157, 8.56483009091514, 20.2871975090982, 0.601074182527025, \r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      1.28158051798986, 1.34386364862063, 1.44128197089458, 1.05188828587237, \r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      1.68463270495257, 0.783928537310326, 0.523130322319754, 1.04988326989747, \r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      1.98236626285113, 2.06845109042637, 2.73362384874613, 4.74208001221555\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       )), row.names = c(NA, -17L), class = \"data.frame\"), MI = structure(list(\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         term = structure(1:17, levels = c(\"(Intercept)\", \"arthritisRheumatoid arthritis\", \r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           \"age.cat50-64\", \"age.cat65+\", \"sexFemale\", \"educationHigh school\", \r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           \"educationCollege graduate or above\", \"raceBlack\", \"raceHispanic\", \r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           \"raceOthers\", \"income$20,000 to $74,999\", \"income$75,000 and Over\", \r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           \"bmi\", \"smokingPrevious smoker\", \"smokingCurrent smoker\", \r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           \"htnYes\", \"diabetesYes\"), class = \"factor\"), Estimate = c(0.0188143292585258, \r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     2.07300070567739, 4.61825007681592, 12.5640740880243, 0.458305850027875, \r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     0.734148738940443, 0.743114292842705, 0.973484188899797, \r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     0.53893399359664, 0.864816782656857, 0.506361550516327, 0.337437164560091, \r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     1.02170527567959, 1.56147517479006, 1.44595134408435, 1.41046315084995, \r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     3.04679581435284), lower = c(0.00748659005258706, 1.27291276796711, \r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  2.40925542188375, 7.60479151007198, 0.345761535249964, 0.422271624545413, \r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  0.414288105082889, 0.667052207938153, 0.280782536102008, \r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  0.442634159267314, 0.334276339621035, 0.213286447694697, \r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  0.991595871883328, 1.2202227744308, 1.02404615326219, 0.784753021984089, \r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  1.97687511645067), upper = c(0.0472817374748467, 3.37598304760657, \r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               8.85262458196902, 20.7574339783405, 0.607482992629369, 1.27636890465482, \r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               1.33293436488269, 1.42068559965813, 1.03442989541381, 1.689675439426, \r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               0.767036099928514, 0.533854078667673, 1.05272893922892, 1.99816359158107, \r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               2.04168072190789, 2.53507313023882, 4.6957770155076)), row.names = c(NA, \r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    -17L), class = \"data.frame\"))\r\n\r\nui <- fluidPage(\r\n  titlePanel(\"Visualization of Imputation Results\"),\r\n  \r\n  sidebarLayout(\r\n    sidebarPanel(\r\n      selectInput(\"selectImp\",\r\n                  \"Select Imputation Iteration:\",\r\n                  choices = c(\"1\", \"2\", \"3\", \"4\", \"5\", \"Multiple imputation\"),\r\n                  selected = \"1\"),\r\n      helpText(\"We explore the association between cardiovascular disease (CVD) and a variety of demographic, health, and lifestyle factors. The analysis is particularly designed to handle survey data that incorporates complex sampling designs and addresses the challenge of missing data by employing multiple imputations (5 imputations in this case).\")\r\n    ),\r\n    \r\n    mainPanel(\r\n      tabsetPanel(\r\n        tabPanel(\"Plot\", plotOutput(\"impPlot\")),\r\n        tabPanel(\"Data\", tableOutput(\"dataTable\"))\r\n      )\r\n    )\r\n  )\r\n)\r\n\r\n\r\nserver <- function(input, output) {\r\n  output$impPlot <- renderPlot({\r\n    iteration <- input$selectImp\r\n    data <- if(iteration == \"Multiple imputation\") list.res$MI else list.res[[as.numeric(iteration)]]\r\n    \r\n    plot_title <- if(iteration == \"Multiple imputation\") {\r\n      \"Forest Plot of Pooled Results\"\r\n    } else {\r\n      paste(\"Forest Plot of Imputation Results from Iteration\", iteration)\r\n    }\r\n    \r\n    ggplot(data, aes(y = term, x = Estimate, xmin = lower, xmax = upper)) +\r\n      geom_point() +  \r\n      geom_errorbarh(height = 0.2) +  \r\n      theme_minimal() +\r\n      labs(x = \"Odds Ratio (OR)\", y = \"\", title = plot_title) +\r\n      xlim(NA, 23) \r\n  })\r\n  \r\n  output$dataTable <- renderTable({\r\n    iteration <- input$selectImp\r\n    data <- if(iteration == \"Multiple imputation\") list.res$MI else list.res[[as.numeric(iteration)]]\r\n    colnames(data) <- c(\"Variables\", \"OR\", \"2.5%\", \"97.5%\")\r\n    \r\n    data\r\n  })\r\n}\r\n\r\n# Run the application \r\nshinyApp(ui = ui, server = server)\r\n","type":"text"}]
